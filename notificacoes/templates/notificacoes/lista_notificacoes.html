{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0 h2"><i class="bi bi-bell-fill me-2"></i>Minhas Notificações</h1>
    
    {% comment %} O botão só aparece se houver notificações para limpar {% endcomment %}
    {% if notificacoes %}
    <form action="{% url 'deletar_todas_notificacoes' %}" method="post" onsubmit="return confirm('Tem certeza que deseja apagar TODAS as suas notificações? Esta ação não pode ser desfeita.');">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">
            <i class="bi bi-trash-fill me-1"></i>Limpar Tudo
        </button>
    </form>
    {% endif %}
</div>

<div class="list-group shadow-sm">
    {% for notificacao in notificacoes %}
        <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            <div>
                <p class="mb-1">{{ notificacao.mensagem }}</p>
                <small class="text-muted">{{ notificacao.data_criacao|date:"d/m/Y H:i" }}</small>
            </div>
            {% comment %} Usar um formulário para deletar individualmente também é mais seguro {% endcomment %}
            <form action="{% url 'deletar_notificacao' notificacao.id %}" method="post">
                 {% csrf_token %}
                 <button type="submit" class="btn btn-sm btn-outline-danger border-0" title="Deletar notificação">&times;</button>
            </form>
        </div>
    {% empty %}
        <div class="list-group-item text-center p-4">
            <i class="bi bi-check-circle-fill fs-3 text-success"></i>
            <p class="mb-0 mt-2">Você está em dia! Nenhuma notificação encontrada.</p>
        </div>
    {% endfor %}
</div>
{% endblock %}